(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[447],{34378:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/nft",function(){return t(3341)}])},3341:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return j}});var r=t(85893),s=t(25675),i=t.n(s),o=t(83078),c=t(34051),a=t.n(c),l=t(67294),d=t(96301),u=t(45220),f=t(45821),p=t(61744),h=t(4672);function m(e,n,t,r,s,i,o){try{var c=e[i](o),a=c.value}catch(l){return void t(l)}c.done?n(a):Promise.resolve(a).then(r,s)}function x(e){var n=e.nftAddress,t=e.tokenId,s=e.isVisible,i=e.marketplaceAddress,c=e.onClose,d=(0,u.lm)(),f=(0,l.useState)(0),x=f[0],v=f[1],g=function(){var e,n=(e=a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(),d({type:"success",message:"listing updated",title:"Listing updated - please refresh (and move blocks)",position:"topR",iconColor:"green"}),e.next=4,n.wait(1);case 4:v("0");case 5:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,s){var i=e.apply(n,t);function o(e){m(i,r,s,o,c,"next",e)}function c(e){m(i,r,s,o,c,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}(),b=(0,o.JX)({abi:h,contractAddress:i,functionName:"updateListing",params:{nftAddress:n,tokenId:t,newPrice:p.fi(x||"0")}}).runContractFunction;return(0,r.jsx)(u.u_,{isVisible:s,onCancel:c,onCloseButtonPressed:c,okText:"Confirm",isCentered:!0,width:"50%",title:"Update Listing",onOk:function(){b({onError:function(e){console.log(e)},onSuccess:g})},children:(0,r.jsx)(u.II,{style:{marginBottom:"24px"},label:"Update listing price (in MATIC)",name:"New listing price",type:"number",onChange:function(e){v(e.target.value)}})})}function v(e,n,t,r,s,i,o){try{var c=e[i](o),a=c.value}catch(l){return void t(l)}c.done?n(a):Promise.resolve(a).then(r,s)}function g(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var i=e.apply(n,t);function o(e){v(i,r,s,o,c,"next",e)}function c(e){v(i,r,s,o,c,"throw",e)}o(void 0)}))}}function b(e){var n=e.nftAddress,t=e.tokenId,s=e.isVisible,i=e.marketplaceAddress,c=e.onClose,l=(0,o.JX)().runContractFunction,d=(0,u.lm)();function f(){return(f=g(a().mark((function e(){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={abi:h,contractAddress:i,functionName:"cancelListing",params:{nftAddress:n,tokenId:t}},e.next=3,l({params:r,onSuccess:p,onError:function(e){return console.log(e)}});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return m.apply(this,arguments)}function m(){return(m=g(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(),e.next=3,n.wait(1);case 3:d({type:"success",message:"listing canceled",title:"Listing canceled - please refresh (and move blocks)",position:"topR",iconColor:"green"});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,r.jsx)(u.u_,{isVisible:s,onCancel:c,onCloseButtonPressed:c,okText:"Confirm",title:"Cancel Listing?",isCentered:!0,width:"30%",onOk:function(){return f.apply(this,arguments)},children:(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)("p",{className:"py-4 font-bold",children:"Are you sure you want to proceed?"})})})}function k(e,n,t,r,s,i,o){try{var c=e[i](o),a=c.value}catch(l){return void t(l)}c.done?n(a):Promise.resolve(a).then(r,s)}function y(e){return function(){var n=this,t=arguments;return new Promise((function(r,s){var i=e.apply(n,t);function o(e){k(i,r,s,o,c,"next",e)}function c(e){k(i,r,s,o,c,"throw",e)}o(void 0)}))}}function A(e){var n=e.price,t=e.nftAddress,s=e.tokenId,c=e.marketplaceAddress,h=e.seller,m=function(e){e.classList.toggle("hidden"),e.classList.toggle("flex")},v=(0,o.Nr)(),g=v.isWeb3Enabled,k=v.account,A=(0,l.useState)(""),j=A[0],w=A[1],N=(0,l.useState)(""),C=N[0],I=N[1],S=(0,l.useState)(""),E=S[0],L=S[1],_=(0,l.useState)(!1),P=_[0],O=_[1],T=(0,l.useState)(!1),B=T[0],V=T[1],X=function(){O(!1),V(!1),console.log("CLOSED AAAAAAAAAAAAAAAA")},M=(0,u.lm)(),R=(0,o.JX)({abi:d.nftAbi,contractAddress:t,functionName:"tokenURI",params:{_tokenId:s}}).runContractFunction,z=(0,o.JX)({abi:d.nftMarketplaceAbi,contractAddress:c,functionName:"buyItem",msgValue:n,params:{nftAddress:t,tokenId:s}}).runContractFunction;function F(){return(F=y(a().mark((function e(){var n,t,r,s,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:if(n=e.sent,console.log("The TokenURI is ".concat(n)),!n){e.next=16;break}return t=n.replace("ipfs://","https://ipfs.io/ipfs/"),e.next=8,fetch(t);case 8:return e.next=10,e.sent.json();case 10:r=e.sent,s=r.image,i=s.replace("ipfs://","https://ipfs.io/ipfs/"),w(i),I(r.name),L(r.description);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,l.useEffect)((function(){g&&function(){F.apply(this,arguments)}()}),[g]);var U=h===k||void 0===h,J=U?"you":function(e,n){if(e.length<=n)return e;var t=n-"...".length,r=Math.ceil(t/2),s=Math.floor(t/2);return e.substring(0,r)+"..."+e.substring(e.length-s)}(h||"",15),W=function(){M({type:"success",message:"Item bought!",title:"Item Bought",position:"topR"})};document.onclick=function(e){var n=document.querySelectorAll(".options"),t=document.querySelectorAll(".edit"),r=!0,s=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){if(o.value.contains(e.target))return}}catch(h){s=!0,i=h}finally{try{r||null==c.return||c.return()}finally{if(s)throw i}}var a=!0,l=!1,d=void 0;try{for(var u,f=n[Symbol.iterator]();!(a=(u=f.next()).done);a=!0){var p=u.value;p.classList.contains("hidden")||m(p)}}catch(h){l=!0,d=h}finally{try{a||null==f.return||f.return()}finally{if(l)throw d}}};return(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:j?(0,r.jsxs)("div",{children:[(0,r.jsx)(x,{isVisible:P,tokenId:s,marketplaceAddress:c,nftAddress:t,onClose:X}),(0,r.jsx)(b,{isVisible:B,tokenId:s,marketplaceAddress:c,nftAddress:t,onClose:X}),(0,r.jsx)(u.Zb,{title:C,description:E,onClick:U?"":function(){z({onError:function(e){return console.log(e)},onSuccess:function(){return W()}})},children:(0,r.jsxs)("div",{className:"p-2",children:[function(){var e="flex justify-".concat(U?"between":"end");return(0,r.jsxs)("div",{className:e,children:[U?(0,r.jsxs)("div",{className:"flex flex-col text-black font-bold edit",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",onClick:function(){var e=document.getElementById(s);m(e)},children:[(0,r.jsx)(f.Oz,{fontSize:"15px"})," ",(0,r.jsx)("span",{children:"Edit"})]}),(0,r.jsxs)("div",{className:"hidden flex-col select absolute z-10 top-12 bg-white rounded-md options",id:s,children:[(0,r.jsxs)("button",{className:"flex gap-2 justify-end items-center hover:bg-slate-200 font-bold p-3 rounded-md border-transparent",onClick:function(){var e=document.getElementById(s);m(e),O(!0)},children:[(0,r.jsx)(f.I8,{fontSize:"16px"}),"Update Listing"]}),(0,r.jsxs)("button",{className:"flex items-center gap-2 hover:bg-slate-200 p-3 font-bold rounded-md border-transparent",onClick:function(){var e=document.getElementById(s);m(e),V(!0)},children:[(0,r.jsx)(f.X1,{fontSize:"16px",fill:"#ef4444"}),(0,r.jsx)("span",{className:" text-red-500",children:"Cancel Listing"})]})]})]}):null,(0,r.jsxs)("div",{children:["#",s]})]})}(),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,r.jsxs)("div",{className:"italic text-sm",children:["Owned by ",J]}),(0,r.jsx)(i(),{loader:function(){return j},src:j,height:"200",width:"200"}),(0,r.jsxs)("div",{className:"font-bold",children:[p.bM(n,"ether")," MATIC"]})]})]})})]}):(0,r.jsx)("div",{children:"Loading..."})})})}function j(){var e=(0,o.Nr)(),n=e.isWeb3Enabled,t=e.chainId,s=(0,o.Oc)("ActiveItem",(function(e){return e.limit(10).descending("tokenId")})),i=s.data,c=s.isFetching;return(0,r.jsxs)("div",{className:"container mx-auto",children:[(0,r.jsx)("h1",{className:"py-4 px-4 font-bold text-2xl",children:"Recently Listed"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-8 nfts px-4",children:n&&d.supportedNetworks.includes(Number(t))?c?(0,r.jsx)("div",{children:"Loading..."}):i.map((function(e){console.log(e.attributes);var n=e.attributes,t=n.price,s=n.nftAddress,i=n.tokenId,o=n.marketplaceAddress,c=n.seller;return(0,r.jsx)(A,{price:t,nftAddress:s,tokenId:i,marketplaceAddress:o,seller:c},"".concat(s).concat(i))})):(0,r.jsx)("div",{children:n?(0,r.jsxs)("div",{className:"font-bold text-lg",children:["Network not supported! Supported networks are:"," ",d.supportedNetworks.join(", ")]}):(0,r.jsx)("div",{className:"font-bold text-lg",children:"Web3 Currently Not Enabled"})})})]})}}},function(e){e.O(0,[956,301,774,888,179],(function(){return n=34378,e(e.s=n);var n}));var n=e.O();_N_E=n}]);